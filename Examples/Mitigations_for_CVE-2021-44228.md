Mitigations for [[CVE-2021-44228]](https://nvd.nist.gov/vuln/detail/CVE-2021-44228) (count: 55):


[[M1013 - Application Developer Guidance]](https://attack.mitre.org/mitigations/M1013) - When possible, include hash values in manifest files to help prevent side-loading of malicious libraries.(Citation: FireEye DLL Side-Loading) - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1015 - Active Directory Configuration]](https://attack.mitre.org/mitigations/M1015) - Manage the access control list for “Replicating Directory Changes” and other permissions associated with domain controller replication. (Citation: AdSecurity DCSync Sept 2015) (Citation: Microsoft Replication ACL) Consider adding users to the "Protected Users" Active Directory security group. This can help limit the caching of users' plaintext credentials.(Citation: Microsoft Protected Users Security Group) - [[T1003]](https://attack.mitre.org/techniques/T1003)

[[M1016 - Vulnerability Scanning]](https://attack.mitre.org/mitigations/M1016) - Continuous monitoring of vulnerability sources and the use of automatic and manual code review tools should also be implemented as well.(Citation: OWASP Top 10) - [[T1195]](https://attack.mitre.org/techniques/T1195)

[[M1017 - User Training]](https://attack.mitre.org/mitigations/M1017) - Users can be trained to identify social engineering techniques and phishing emails. - [[T1566]](https://attack.mitre.org/techniques/T1566)

[[M1017 - User Training]](https://attack.mitre.org/mitigations/M1017) - Limit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts. - [[T1003]](https://attack.mitre.org/techniques/T1003)

[[M1018 - User Account Management]](https://attack.mitre.org/mitigations/M1018) - Enforce the principle of least privilege by limiting privileges of user accounts so only authorized accounts can modify and/or add server software components.(Citation: NSA and ASD Detect and Prevent Web Shells 2020) - [[T1505]](https://attack.mitre.org/techniques/T1505)

[[M1018 - User Account Management]](https://attack.mitre.org/mitigations/M1018) - Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service binary target path locations. Deny execution from user directories such as file download directories and temp directories where able.Ensure that proper permissions and directory access control are set to deny users the ability to write files to the top-level directory C: and system directories, such as C:\Windows\, to reduce places where malicious files could be placed for execution. - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1018 - User Account Management]](https://attack.mitre.org/mitigations/M1018) - An adversary must already have administrator level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require.   - [[T1134]](https://attack.mitre.org/techniques/T1134)

[[M1019 - Threat Intelligence Program]](https://attack.mitre.org/mitigations/M1019) - Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization. - [[T1068]](https://attack.mitre.org/techniques/T1068)

[[M1021 - Restrict Web-Based Content]](https://attack.mitre.org/mitigations/M1021) - Determine if certain websites or attachment types (ex: .scr, .exe, .pif, .cpl, etc.) that can be used for phishing are necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk. - [[T1566]](https://attack.mitre.org/techniques/T1566)

[[M1021 - Restrict Web-Based Content]](https://attack.mitre.org/mitigations/M1021) - Web proxies can be used to enforce external network communication policy that prevents use of unauthorized external services. - [[T1102]](https://attack.mitre.org/techniques/T1102)

[[M1021 - Restrict Web-Based Content]](https://attack.mitre.org/mitigations/M1021) - Script blocking extensions can help prevent the execution of scripts and HTA files that may commonly be used during the exploitation process. For malicious code served up through ads, adblockers can help prevent that code from executing in the first place. - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1022 - Restrict File and Directory Permissions]](https://attack.mitre.org/mitigations/M1022) - Install software in write-protected locations. Set directory access controls to prevent file writes to the search paths for applications, both in the folders where applications are run from and the standard library folders. - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1024 - Restrict Registry Permissions]](https://attack.mitre.org/mitigations/M1024) - Consider using Group Policy to configure and block modifications to service and other critical server parameters in the Registry.(Citation: Microsoft System Services Fundamentals) - [[T1505]](https://attack.mitre.org/techniques/T1505)

[[M1024 - Restrict Registry Permissions]](https://attack.mitre.org/mitigations/M1024) - Ensure proper permissions are set for Registry hives to prevent users from modifying keys for system components that may lead to privilege escalation. - [[T1112]](https://attack.mitre.org/techniques/T1112)&emsp;[[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1025 - Privileged Process Integrity]](https://attack.mitre.org/mitigations/M1025) - On Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA.(Citation: Microsoft LSA) - [[T1003]](https://attack.mitre.org/techniques/T1003)

[[M1026 - Privileged Account Management]](https://attack.mitre.org/mitigations/M1026) - Do not allow administrator accounts that have permissions to add component software on these services to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems. - [[T1505]](https://attack.mitre.org/techniques/T1505)

[[M1026 - Privileged Account Management]](https://attack.mitre.org/mitigations/M1026) - Limit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create a token object. (Citation: Microsoft Create Token) Also define who can create a process level token to only the local and network service through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace a process level token.(Citation: Microsoft Replace Process Token)Administrators should log in as a standard user but run their tools with administrator privileges using the built-in access token manipulation command runas.(Citation: Microsoft runas) - [[T1134]](https://attack.mitre.org/techniques/T1134)

[[M1026 - Privileged Account Management]](https://attack.mitre.org/mitigations/M1026) - Windows:Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.(Citation: Microsoft Securing Privileged Access)Linux:Scraping the passwords from memory requires root privileges. Follow best practices in restricting access to privileged accounts to avoid hostile programs from accessing such sensitive regions of memory. - [[T1003]](https://attack.mitre.org/techniques/T1003)

[[M1026 - Privileged Account Management]](https://attack.mitre.org/mitigations/M1026) - Limit the number of accounts with permissions to create other accounts. Do not allow domain administrator accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems. - [[T1136]](https://attack.mitre.org/techniques/T1136)

[[M1026 - Privileged Account Management]](https://attack.mitre.org/mitigations/M1026) - When PowerShell is necessary, consider restricting PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration.(Citation: Netspi PowerShell Execution Policy Bypass)PowerShell JEA (Just Enough Administration) may also be used to sandbox administration and limit what commands admins/users can execute through remote PowerShell sessions.(Citation: Microsoft PS JEA) - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1027 - Password Policies]](https://attack.mitre.org/mitigations/M1027) - Ensure that local administrator accounts have complex, unique passwords across all systems on the network. - [[T1003]](https://attack.mitre.org/techniques/T1003)

[[M1028 - Operating System Configuration]](https://attack.mitre.org/mitigations/M1028) - Consider disabling or restricting NTLM.(Citation: Microsoft Disable NTLM Nov 2012) Consider disabling WDigest authentication.(Citation: Microsoft WDigest Mit) - [[T1003]](https://attack.mitre.org/techniques/T1003)

[[M1028 - Operating System Configuration]](https://attack.mitre.org/mitigations/M1028) - Protect domain controllers by ensuring proper security configuration for critical servers. - [[T1136]](https://attack.mitre.org/techniques/T1136)

[[M1030 - Network Segmentation]](https://attack.mitre.org/mitigations/M1030) - Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports and through proper network gateway systems. Also ensure hosts are only provisioned to communicate over authorized interfaces. - [[T1095]](https://attack.mitre.org/techniques/T1095)

[[M1030 - Network Segmentation]](https://attack.mitre.org/mitigations/M1030) - Configure access controls and firewalls to limit access to domain controllers and systems used to create and manage accounts. - [[T1136]](https://attack.mitre.org/techniques/T1136)

[[M1031 - Network Intrusion Prevention]](https://attack.mitre.org/mitigations/M1031) - Network intrusion prevention systems and systems designed to scan and remove malicious email attachments or links can be used to block activity. - [[T1566]](https://attack.mitre.org/techniques/T1566)

[[M1031 - Network Intrusion Prevention]](https://attack.mitre.org/mitigations/M1031) - Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. - [[T1071]](https://attack.mitre.org/techniques/T1071)&emsp;[[T1095]](https://attack.mitre.org/techniques/T1095)&emsp;[[T1102]](https://attack.mitre.org/techniques/T1102)

[[M1031 - Network Intrusion Prevention]](https://attack.mitre.org/mitigations/M1031) - Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.(Citation: University of Birmingham C2) - [[T1105]](https://attack.mitre.org/techniques/T1105)

[[M1032 - Multi-factor Authentication]](https://attack.mitre.org/mitigations/M1032) - Use multi-factor authentication for user and privileged accounts. - [[T1136]](https://attack.mitre.org/techniques/T1136)

[[M1037 - Filter Network Traffic]](https://attack.mitre.org/mitigations/M1037) - Filter network traffic to prevent use of protocols across the network boundary that are unnecessary. - [[T1095]](https://attack.mitre.org/techniques/T1095)

[[M1038 - Execution Prevention]](https://attack.mitre.org/mitigations/M1038) - Adversaries may use new payloads to execute this technique. Identify and block potentially malicious software executed through hijacking by using application control solutions also capable of blocking libraries loaded by legitimate software. - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1038 - Execution Prevention]](https://attack.mitre.org/mitigations/M1038) - Consider blocking the execution of known vulnerable drivers that adversaries may exploit to execute code in kernel mode. Validate driver block rules in audit mode to ensure stability prior to production deployment.(Citation: Microsoft Driver Block Rules) - [[T1068]](https://attack.mitre.org/techniques/T1068)

[[M1038 - Execution Prevention]](https://attack.mitre.org/mitigations/M1038) - Use application control where appropriate. For example, PowerShell Constrained Language mode can be used to restrict access to sensitive or otherwise dangerous language elements such as those used to execute arbitrary Windows APIs or files (e.g., `Add-Type`).(Citation: Microsoft PowerShell CLM) - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1040 - Behavior Prevention on Endpoint]](https://attack.mitre.org/mitigations/M1040) - Some endpoint security solutions can be configured to block some types of behaviors related to process injection/memory tampering based on common sequences of indicators (ex: execution of specific API functions). - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1040 - Behavior Prevention on Endpoint]](https://attack.mitre.org/mitigations/M1040) - On Windows 10, enable Attack Surface Reduction (ASR) rules to secure LSASS and prevent credential stealing. (Citation: win10_asr) - [[T1003]](https://attack.mitre.org/techniques/T1003)

[[M1040 - Behavior Prevention on Endpoint]](https://attack.mitre.org/mitigations/M1040) - On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent [Visual Basic](https://attack.mitre.org/techniques/T1059/005) and [JavaScript](https://attack.mitre.org/techniques/T1059/007) scripts from executing potentially malicious downloaded content (Citation: win10_asr). - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1041 - Encrypt Sensitive Information]](https://attack.mitre.org/mitigations/M1041) - Ensure Domain Controller backups are properly secured. - [[T1003]](https://attack.mitre.org/techniques/T1003)

[[M1042 - Disable or Remove Feature or Program]](https://attack.mitre.org/mitigations/M1042) - Consider disabling software components from servers when possible to prevent abuse by adversaries.(Citation: ITSyndicate Disabling PHP functions) - [[T1505]](https://attack.mitre.org/techniques/T1505)

[[M1042 - Disable or Remove Feature or Program]](https://attack.mitre.org/mitigations/M1042) - Disable or remove any unnecessary or unused shells or interpreters. - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1043 - Credential Access Protection]](https://attack.mitre.org/mitigations/M1043) - With Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. (Citation: TechNet Credential Guard) It also does not protect against all forms of credential dumping. (Citation: GitHub SHB Credential Guard) - [[T1003]](https://attack.mitre.org/techniques/T1003)

[[M1044 - Restrict Library Loading]](https://attack.mitre.org/mitigations/M1044) - Disallow loading of remote DLLs. This is included by default in Windows Server 2012+ and is available by patch for XP+ and Server 2003+.Enable Safe DLL Search Mode to force search for system DLLs in directories with greater restrictions (e.g. %SYSTEMROOT%)to be used before local directory DLLs (e.g. a user's home directory)The Safe DLL Search Mode can be enabled via Group Policy at Computer Configuration > [Policies] > Administrative Templates > MSS (Legacy): MSS: (SafeDllSearchMode) Enable Safe DLL search mode. The associated Windows Registry key for this is located at HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\SafeDLLSearchMode(Citation: Microsoft More information about DLL)(Citation: Microsoft Dynamic Link Library Search Order) - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1045 - Code Signing]](https://attack.mitre.org/mitigations/M1045) - Ensure all application component binaries are signed by the correct application developers. - [[T1505]](https://attack.mitre.org/techniques/T1505)

[[M1045 - Code Signing]](https://attack.mitre.org/mitigations/M1045) - Where possible, only permit execution of signed scripts. - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1047 - Audit]](https://attack.mitre.org/mitigations/M1047) - Regularly check component software on critical services that adversaries may target for persistence to verify the integrity of the systems and identify if unexpected changes have been made. - [[T1505]](https://attack.mitre.org/techniques/T1505)

[[M1047 - Audit]](https://attack.mitre.org/mitigations/M1047) - Use auditing tools capable of detecting hijacking opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for hijacking weaknesses.(Citation: Powersploit)Use the program sxstrace.exe that is included with Windows along with manual inspection to check manifest files for side-loading vulnerabilities in software.Find and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.Clean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.(Citation: Microsoft CreateProcess)(Citation: Microsoft Dynamic-Link Library Security)(Citation: Vulnerability and Exploit Detector) - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1048 - Application Isolation and Sandboxing]](https://attack.mitre.org/mitigations/M1048) - Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. Risks of additional exploits and weaknesses in these systems may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape) - [[T1068]](https://attack.mitre.org/techniques/T1068)

[[M1049 - Antivirus/Antimalware]](https://attack.mitre.org/mitigations/M1049) - Anti-virus can automatically quarantine suspicious files. - [[T1566]](https://attack.mitre.org/techniques/T1566)

[[M1049 - Antivirus/Antimalware]](https://attack.mitre.org/mitigations/M1049) - Anti-virus can be used to automatically quarantine suspicious files.  - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1050 - Exploit Protection]](https://attack.mitre.org/mitigations/M1050) - Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. (Citation: TechNet Moving Beyond EMET) Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. (Citation: Wikipedia Control Flow Integrity) Many of these protections depend on the architecture and target application binary for compatibility and may not work for software components targeted for privilege escalation. - [[T1068]](https://attack.mitre.org/techniques/T1068)

[[M1051 - Update Software]](https://attack.mitre.org/mitigations/M1051) - Update software regularly to include patches that fix DLL side-loading vulnerabilities. - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1051 - Update Software]](https://attack.mitre.org/mitigations/M1051) - Update software regularly by employing patch management for internal enterprise endpoints and servers. - [[T1068]](https://attack.mitre.org/techniques/T1068)

[[M1051 - Update Software]](https://attack.mitre.org/mitigations/M1051) - A patch management process should be implemented to check unused dependencies, unmaintained and/or previously vulnerable dependencies, unnecessary features, components, files, and documentation. - [[T1195]](https://attack.mitre.org/techniques/T1195)

[[M1052 - User Account Control]](https://attack.mitre.org/mitigations/M1052) - Turn off UAC's privilege elevation for standard users [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System] to automatically deny elevation requests, add: "ConsentPromptBehaviorUser"=dword:00000000. Consider enabling installer detection for all users by adding: "EnableInstallerDetection"=dword:00000001. This will prompt for a password for installation and also log the attempt. To disable installer detection, instead add: "EnableInstallerDetection"=dword:00000000. This may prevent potential elevation of privileges through exploitation during the process of UAC detecting the installer, but will allow the installation process to continue without being logged.  (Citation: Executable Installers are Vulnerable) - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1054 - Software Configuration]](https://attack.mitre.org/mitigations/M1054) - Use anti-spoofing and email authentication mechanisms to filter messages based on validity checks of the sender domain (using SPF) and integrity of messages (using DKIM). Enabling these mechanisms within an organization (through policies such as DMARC) may enable recipients (intra-org and cross domain) to perform similar message filtering and validation.(Citation: Microsoft Anti Spoofing)(Citation: ACSC Email Spoofing) - [[T1566]](https://attack.mitre.org/techniques/T1566)

CVE Link on [[Alienvault]](https://otx.alienvault.com/indicator/cve/CVE-2021-44228)