Mitigations for [[CVE-2021-44228]](https://nvd.nist.gov/vuln/detail/CVE-2021-44228) (count: 33):


[[M1013 - Application Developer Guidance]](https://attack.mitre.org/mitigations/M1013) - When possible, include hash values in manifest files to help prevent side-loading of malicious libraries.(Citation: FireEye DLL Side-Loading) - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1016 - Vulnerability Scanning]](https://attack.mitre.org/mitigations/M1016) - Continuous monitoring of vulnerability sources and the use of automatic and manual code review tools should also be implemented as well.(Citation: OWASP Top 10) - [[T1195]](https://attack.mitre.org/techniques/T1195)

[[M1018 - User Account Management]](https://attack.mitre.org/mitigations/M1018) - Enforce the principle of least privilege by limiting privileges of user accounts so only authorized accounts can modify and/or add server software components.(Citation: NSA and ASD Detect and Prevent Web Shells 2020) - [[T1505]](https://attack.mitre.org/techniques/T1505)

[[M1018 - User Account Management]](https://attack.mitre.org/mitigations/M1018) - Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service binary target path locations. Deny execution from user directories such as file download directories and temp directories where able.  Ensure that proper permissions and directory access control are set to deny users the ability to write files to the top-level directory <code>C:</code> and system directories, such as <code>C:\Windows\</code>, to reduce places where malicious files could be placed for execution. - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1019 - Threat Intelligence Program]](https://attack.mitre.org/mitigations/M1019) - Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization. - [[T1068]](https://attack.mitre.org/techniques/T1068)

[[M1021 - Restrict Web-Based Content]](https://attack.mitre.org/mitigations/M1021) - Script blocking extensions can help prevent the execution of scripts and HTA files that may commonly be used during the exploitation process. For malicious code served up through ads, adblockers can help prevent that code from executing in the first place. - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1022 - Restrict File and Directory Permissions]](https://attack.mitre.org/mitigations/M1022) - Install software in write-protected locations. Set directory access controls to prevent file writes to the search paths for applications, both in the folders where applications are run from and the standard library folders. - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1024 - Restrict Registry Permissions]](https://attack.mitre.org/mitigations/M1024) - Consider using Group Policy to configure and block modifications to service and other critical server parameters in the Registry.(Citation: Microsoft System Services Fundamentals) - [[T1505]](https://attack.mitre.org/techniques/T1505)

[[M1024 - Restrict Registry Permissions]](https://attack.mitre.org/mitigations/M1024) - Ensure proper permissions are set for Registry hives to prevent users from modifying keys for system components that may lead to privilege escalation. - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1026 - Privileged Account Management]](https://attack.mitre.org/mitigations/M1026) - When PowerShell is necessary, consider restricting PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration.(Citation: Netspi PowerShell Execution Policy Bypass)  PowerShell JEA (Just Enough Administration) may also be used to sandbox administration and limit what commands admins/users can execute through remote PowerShell sessions.(Citation: Microsoft PS JEA) - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1026 - Privileged Account Management]](https://attack.mitre.org/mitigations/M1026) - Do not allow administrator accounts that have permissions to add component software on these services to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems. - [[T1505]](https://attack.mitre.org/techniques/T1505)

[[M1030 - Network Segmentation]](https://attack.mitre.org/mitigations/M1030) - Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports and through proper network gateway systems. Also ensure hosts are only provisioned to communicate over authorized interfaces. - [[T1095]](https://attack.mitre.org/techniques/T1095)

[[M1031 - Network Intrusion Prevention]](https://attack.mitre.org/mitigations/M1031) - Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. - [[T1071]](https://attack.mitre.org/techniques/T1071)&emsp;[[T1095]](https://attack.mitre.org/techniques/T1095)

[[M1037 - Filter Network Traffic]](https://attack.mitre.org/mitigations/M1037) - Filter network traffic to prevent use of protocols across the network boundary that are unnecessary. - [[T1095]](https://attack.mitre.org/techniques/T1095)

[[M1038 - Execution Prevention]](https://attack.mitre.org/mitigations/M1038) - Consider blocking the execution of known vulnerable drivers that adversaries may exploit to execute code in kernel mode. Validate driver block rules in audit mode to ensure stability prior to production deployment.(Citation: Microsoft Driver Block Rules) - [[T1068]](https://attack.mitre.org/techniques/T1068)

[[M1038 - Execution Prevention]](https://attack.mitre.org/mitigations/M1038) - Use application control where appropriate. For example, PowerShell Constrained Language mode can be used to restrict access to sensitive or otherwise dangerous language elements such as those used to execute arbitrary Windows APIs or files (e.g., `Add-Type`).(Citation: Microsoft PowerShell CLM) - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1038 - Execution Prevention]](https://attack.mitre.org/mitigations/M1038) - Adversaries may use new payloads to execute this technique. Identify and block potentially malicious software executed through hijacking by using application control solutions also capable of blocking libraries loaded by legitimate software. - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1040 - Behavior Prevention on Endpoint]](https://attack.mitre.org/mitigations/M1040) - On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent [Visual Basic](https://attack.mitre.org/techniques/T1059/005) and [JavaScript](https://attack.mitre.org/techniques/T1059/007) scripts from executing potentially malicious downloaded content (Citation: win10_asr). - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1040 - Behavior Prevention on Endpoint]](https://attack.mitre.org/mitigations/M1040) - Some endpoint security solutions can be configured to block some types of behaviors related to process injection/memory tampering based on common sequences of indicators (ex: execution of specific API functions). - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1042 - Disable or Remove Feature or Program]](https://attack.mitre.org/mitigations/M1042) - Disable or remove any unnecessary or unused shells or interpreters. - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1042 - Disable or Remove Feature or Program]](https://attack.mitre.org/mitigations/M1042) - Consider disabling software components from servers when possible to prevent abuse by adversaries.(Citation: ITSyndicate Disabling PHP functions) - [[T1505]](https://attack.mitre.org/techniques/T1505)

[[M1044 - Restrict Library Loading]](https://attack.mitre.org/mitigations/M1044) - Disallow loading of remote DLLs. This is included by default in Windows Server 2012+ and is available by patch for XP+ and Server 2003+.  Enable Safe DLL Search Mode to force search for system DLLs in directories with greater restrictions (e.g. <code>%SYSTEMROOT%</code>)to be used before local directory DLLs (e.g. a user's home directory)  The Safe DLL Search Mode can be enabled via Group Policy at Computer Configuration > [Policies] > Administrative Templates > MSS (Legacy): MSS: (SafeDllSearchMode) Enable Safe DLL search mode. The associated Windows Registry key for this is located at <code>HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\SafeDLLSearchMode</code>(Citation: Microsoft More information about DLL)(Citation: Microsoft Dynamic Link Library Search Order) - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1045 - Code Signing]](https://attack.mitre.org/mitigations/M1045) - Where possible, only permit execution of signed scripts. - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1045 - Code Signing]](https://attack.mitre.org/mitigations/M1045) - Ensure all application component binaries are signed by the correct application developers. - [[T1505]](https://attack.mitre.org/techniques/T1505)

[[M1047 - Audit]](https://attack.mitre.org/mitigations/M1047) - Regularly check component software on critical services that adversaries may target for persistence to verify the integrity of the systems and identify if unexpected changes have been made. - [[T1505]](https://attack.mitre.org/techniques/T1505)

[[M1047 - Audit]](https://attack.mitre.org/mitigations/M1047) - Use auditing tools capable of detecting hijacking opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for hijacking weaknesses.(Citation: Powersploit)  Use the program sxstrace.exe that is included with Windows along with manual inspection to check manifest files for side-loading vulnerabilities in software.  Find and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.  Clean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.(Citation: Microsoft CreateProcess)(Citation: Microsoft Dynamic-Link Library Security)(Citation: Vulnerability and Exploit Detector) - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1048 - Application Isolation and Sandboxing]](https://attack.mitre.org/mitigations/M1048) - Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. Risks of additional exploits and weaknesses in these systems may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape) - [[T1068]](https://attack.mitre.org/techniques/T1068)

[[M1049 - Antivirus/Antimalware]](https://attack.mitre.org/mitigations/M1049) - Anti-virus can be used to automatically quarantine suspicious files.  - [[T1059]](https://attack.mitre.org/techniques/T1059)

[[M1050 - Exploit Protection]](https://attack.mitre.org/mitigations/M1050) - Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. (Citation: TechNet Moving Beyond EMET) Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. (Citation: Wikipedia Control Flow Integrity) Many of these protections depend on the architecture and target application binary for compatibility and may not work for software components targeted for privilege escalation. - [[T1068]](https://attack.mitre.org/techniques/T1068)

[[M1051 - Update Software]](https://attack.mitre.org/mitigations/M1051) - Update software regularly by employing patch management for internal enterprise endpoints and servers. - [[T1068]](https://attack.mitre.org/techniques/T1068)

[[M1051 - Update Software]](https://attack.mitre.org/mitigations/M1051) - A patch management process should be implemented to check unused dependencies, unmaintained and/or previously vulnerable dependencies, unnecessary features, components, files, and documentation. - [[T1195]](https://attack.mitre.org/techniques/T1195)

[[M1051 - Update Software]](https://attack.mitre.org/mitigations/M1051) - Update software regularly to include patches that fix DLL side-loading vulnerabilities. - [[T1574]](https://attack.mitre.org/techniques/T1574)

[[M1052 - User Account Control]](https://attack.mitre.org/mitigations/M1052) - Turn off UAC's privilege elevation for standard users <code>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System]</code> to automatically deny elevation requests, add: <code>"ConsentPromptBehaviorUser"=dword:00000000</code>. Consider enabling installer detection for all users by adding: <code>"EnableInstallerDetection"=dword:00000001</code>. This will prompt for a password for installation and also log the attempt. To disable installer detection, instead add: <code>"EnableInstallerDetection"=dword:00000000</code>. This may prevent potential elevation of privileges through exploitation during the process of UAC detecting the installer, but will allow the installation process to continue without being logged.  (Citation: Executable Installers are Vulnerable) - [[T1574]](https://attack.mitre.org/techniques/T1574)

CVE Link on [[Alienvault]](https://otx.alienvault.com/indicator/cve/CVE-2021-44228)