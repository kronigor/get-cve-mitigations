# CVE or TTPs Mitigation Finder (from MITRE ATT&CK)

## Description
This script retrieves mitigations from the MITRE ATT&CK database for given CVEs or TTPs. It can extract TTPs from a list of CVEs (from alienvault.com) and find corresponding mitigations, or directly retrieve mitigations for given TTPs. Additionally, it supports updating local MITRE ATT&CK data files and can leverage an external API for enhanced CVE to TTP mapping.


### Key Features
- **CVE to TTP Mapping**: Extracts TTPs for specified CVEs using data from alienvault.com.
- **Direct TTP Mitigation Retrieval**: Allows users to input specific TTPs and retrieve associated mitigations.
- **Local and Online Data Access**: Supports both online retrieval from the AlienVault database and offline access using local JSON files.
- **API Integration**: Utilizes an API key from alienvault.com for enhanced CVE to TTP mapping.
- **Data Update Feature**: Includes an option to update local MITRE ATT&CK data files.


## Installation
Ensure you have Python version 3.x installed. To install necessary dependencies, use the provided `requirements.txt`:
```
pip install -r requirements.txt
```

## Usage

### Command-Line Arguments
- `-c`, `--cve`: Comma-separated list of CVE identifiers. This script will extract TTPs from CVEs (from alienvault.com) and find corresponding mitigations.
- `-t`, `--ttp`: Comma-separated list of TTP identifiers for which the script will find mitigations.
- `-a`,`--api`: API key for accessing enhanced CVE to TTP mapping through the https://otx.alienvault.com/ service. Provide the API key to enable this feature. Required when using the `--cve` argument.
- `-u`,`--update`: Boolean flag to trigger the update (download) of local MITRE ATT&CK data file (enterprise-attack.json). Defaults to False.

### Calling the Help Menu
To see all available command-line options and get general information about the script, use the `-h` or `--help` argument:
```
python get_cve_mitigations.py -h

python get_cve_mitigations.py --help
```

### Using 
To run the script with Python, use the following command:
```
get_cve_mitigations.py [-h] [-c CVE] [-t TTP] [-u] [-a API]
```

Example usage:
- To search for mitigations for the specified list of CVEs:
```
python get_cve_mitigations.py -с "CVE-2021-44228"

python get_cve_mitigations.py -с "CVE-2021-44228,CVE-2017-6742"
```
- To search for mitigations for the specified list of TTPs:
```
python get_cve_mitigations.py -t "T1078"

python get_cve_mitigations.py -t "TA0001,T1190,T1059.004"
```
- To enter the API key for the https://otx.alienvault.com/ service:
```
python get_cve_mitigations.py -a YOUR_API_KEY
```
**Note:**
Replace `YOUR_API_KEY` with your actual API key from https://otx.alienvault.com/.
This argument must be used in conjunction with the `-c/--cve` argument.
- To update MITRE ATT&CK data file (enterprise-attack.json):
```
python get_cve_mitigations.py -u
```

## License
This project is licensed under the GNU General Public License (GPL).
